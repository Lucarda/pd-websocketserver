git: 
  depth: 3
install: 
  - "curl -L http://msp.ucsd.edu/Software/pd-0.51-4.mac.tar.gz -o ./pd.tar.gz"
  - "tar zxvf ./pd.tar.gz"
language: c
os: osx
script: 
  - "make PDDIR=Pd-0.51-4.app/Contents/Resources/ PDLIBDIR=./out-osx install"
after_success: 
  - "zip -r osx-release.zip ./osx-release"
deploy:
  provider: releases
  draft: true
  name: ${TRAVIS_TAG}
  tag_name: ${TRAVIS_TAG}
  api_key: 
    secure: "xCI7/huM7Q0VkNyGJoyRyxZT15wiGDoKBEVIRmabMwGVd3xrgVp6YUN8VeQUJ+Q8Z4Za+TpqsS3S6jC2/B3NsupmozRQ8aZVjJmwouSJa6uJYPT19r7CJWGBHtPQp5utJv5b1vZyaffyDGN/pFxzb/eUWKJZ+fPjrVNfLrAF5FMJbijCK6fdf4Wd53fHhUf0CKnA6xbF0pBRBXmOfhwn2I0MS53CnEQk8GVwhHebWVZ+snQOU+ClGhryiJ3/CGSBwUrru8Fuq146qYxnLf5l1VqLgRy2y488D2t/fdNCuflg5DmbZOmH65zbpBKwidPncSkLpT2OiVULahQKOqQXecBk/UkfWdRDXJtvxZydnBKOf8bHGH2aIuG5gV4S34hAxquodT9A07d8M+5jq6S0khsjEWX7q32z8HgQCemHKj7V49lPWG3AKdgyhiFeyJj1ilHbi19Nm84+PuPzgSHB1bcjbF8zDq1LLpxlHzprUq2K4/Ba0A8e9AgyLYDTMAnLnCrAUx9OhlFYc5wfQAwBD+rbAov6bLw02ivy4ePK/qmSPXqxz8z2XQYvJVseiUTGZg2Qy2oB1OVHHyP0kZUZdb8NL9lEgfF/X4lijCc4wX1/do6qrAcvWk4WTYxZhiUyk3XZUvzeDmtCizWma8A6rAONhfHaqhE6aD4O6XU2mmk=" 
  file: "osx-release.zip"
  skip_cleanup: true
  on:
    repo: Lucarda/pd-websocketserver
    tags: true