git: 
  depth: 3
install: 
  - "curl -L http://msp.ucsd.edu/Software/pd-0.51-4.mac.tar.gz -o ./pd.tar.gz"
  - "tar zxvf ./pd.tar.gz"
language: c
os: osx
script: 
  - "make PDDIR=Pd-0.51-4.app/Contents/Resources/ PDLIBDIR=./out-osx install"
after_success: 
  - "zip -r osx-release.zip ./osx-release"
deploy:
  provider: releases
  draft: true
  name: ${TRAVIS_TAG}
  tag_name: ${TRAVIS_TAG}
  api_key: 
    secure: ihmrcpQd5lLch5RCsbItiFlaerlmBKlyj20v+vHczmpLG5DNNkP2cr1jZBSbMvyFqtvPGW0+q8rEJiqvh9/ZnbTq/DxkHSkwkvMhgjVwen/StcuNkSJ3OL6ZGTcxMmehKofRfVFPRG041w1TQoVqytWUoNsiT81B/1I6mB8fCdCaA21d9R7G15Nfe2UcDu9gcyiWEANcUh/NnL4a9vS8x+siN6Ne1fhhkR5FDuLjkR/DN1BkNlgkNb8rsFN1UqIJVK3C1NygJEarVTu1JmpaSOHq5IVmexiw+5rskB6f3M18RE89hBqFVSgKTFqmdklI3AyToJU/NnVst9YlUHaJ3IszoASRTNFluecNPGMDx4NwRGSBf5wZvnvPLMqbOrTbDssS5e4GJsViymFP9JRZ9YclXW8xHxqqDF3Eq/V3NFiPBBdqi6QYAedpF5qumglouA4TAPT2MfSgfZ4MpiD51T+K41ESUuI2q8SlElUnwoWhfv9Fe9BG4khhC2ol6vAwF29MCu6LM6P+FpnfZv0AECj3c1pOTxVnVEsH4d0zmBpyARyL2SKAZZ3MhBKlyifXXE4lHArfVj4ygJXZ3JyvqIQtj0m/DxlG7ZeSb6/CZ82eQ/beIYx9McLWbWc27IFKDeTpV1kV0C1/XSuLrjSUvsQcsH8nZ7G8BXRero4K51M= 
  file: "osx-release.zip"
  skip_cleanup: true
  on:
    repo: Lucarda/pd-websocketserver
    tags: true